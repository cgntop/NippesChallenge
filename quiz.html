<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Station 3 – Quiz</title>
<link rel="stylesheet" href="assets.css">
<div class="main">
  <h1>Station 3 – Quiz</h1>
  <h2>Beantworte alle Fragen</h2>
  <div id="quiz"></div>
  <a class="btn primary" href="#" id="check">Auswerten</a>
  <div id="result" class="result"></div>
</div>
<script src="loader.js"></script>
<script>
function renderQuiz(cfg){
  const holder = document.getElementById('quiz');
  holder.innerHTML = '';
  const q = cfg.quiz;
  if(!q){ holder.textContent='Kein Quiz in config.json'; return; }
  q.questions.forEach((item, qi)=>{
    const qel = document.createElement('div');
    qel.className='q';
    qel.textContent = (qi+1) + ') ' + item.text;
    holder.appendChild(qel);
    item.options.forEach((opt, oi)=>{
      const lab = document.createElement('label');
      lab.className='opt';
      const inp = document.createElement('input');
      inp.type='radio'; inp.name='q'+qi; inp.value=oi;
      lab.appendChild(inp);
      lab.append(' ' + opt);
      holder.appendChild(lab);
    });
  });
  document.getElementById('check').onclick = (e)=>{
    e.preventDefault();
    let ok = true, correct = 0;
    q.questions.forEach((item, qi)=>{
      const sel = document.querySelector('input[name="q'+qi+'"]:checked');
      if(!sel) ok = false;
      else if(parseInt(sel.value,10)===item.correctIndex) correct++;
    });
    const res = document.getElementById('result');
    res.style.display='block';
    if(!ok){ res.innerHTML = 'Bitte alle Fragen beantworten.'; return; }
    if(correct === q.questions.length){
      const letters = (q.lettersOnSuccess||[]).join(' ');
      res.innerHTML = '<strong>Top!</strong> Die Buchstaben sind: <strong>'+letters+'</strong>';
    }else{
      res.innerHTML = 'Noch nicht ganz richtig – versucht es nochmal!';
    }
  };
}
loadConfig().then(cfg=>renderQuiz(cfg)).catch(()=>{
  document.getElementById('quiz').textContent = 'Fehler beim Laden der config.json';
});
</script>
